<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="description" content="Fast, responsive client-side Image Resizer & compressor — resize, change format, and optimize images in the browser. Perfect for web developers and content creators.">
  <meta name="keywords" content="image resizer, image compressor, web image optimization, resize image online, compress image">
  <meta name="author" content="Your Name">

  <!-- Open Graph / Social -->
  <meta property="og:title" content="Image Resizer — Fast, Responsive, Client-side" />
  <meta property="og:description" content="Resize and compress images in the browser. Change format, choose compression level, and download optimized images." />
  <meta property="og:type" content="website" />

  <title>Image Resizer — Responsive Image Compressor</title>

  <!-- Minimal CSS (responsive) - clear styles provided so it's self-contained -->
  <style>
    :root{--accent:#0ea5a3;--muted:#6b7280;--bg:#0f172a}
    *{box-sizing:border-box}
    body{font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; margin:0; background:linear-gradient(180deg,#fff 0%, #f8fafc 100%); color:#0f172a}
    .container{max-width:1100px;margin:28px auto;padding:20px}
    header{display:flex;align-items:center;justify-content:space-between;gap:16px}
    h1{margin:0;font-size:20px}
    p.lead{margin:6px 0 0;color:var(--muted);font-size:14px}

    .grid{display:grid;grid-template-columns:1fr 380px;gap:20px;margin-top:20px}
    @media (max-width:900px){.grid{grid-template-columns:1fr}}

    .card{background:white;border-radius:12px;padding:16px;box-shadow:0 6px 18px rgba(15,23,42,0.06)}

    .drop{border:2px dashed #e6eef0;border-radius:10px;padding:18px;text-align:center;cursor:pointer}
    .drop.dragover{border-color:var(--accent);background:#f8fffe}
    .controls{display:flex;flex-direction:column;gap:12px}
    .row{display:flex;gap:8px;align-items:center}
    .row.space{justify-content:space-between}
    label{font-size:13px;color:var(--muted)}
    input[type='range']{width:100%}
    select,input[type='number'],input[type='text']{padding:8px;border-radius:8px;border:1px solid #e6eef0;font-size:14px}
    button{background:var(--accent);color:white;padding:10px 12px;border-radius:10px;border:0;cursor:pointer}
    button.secondary{background:#eef2f2;color:var(--muted)}
    .preview-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:12px;margin-top:12px}
    .preview{border:1px solid #eef2f2;border-radius:8px;padding:8px;background:#fff}
    .preview img{max-width:100%;height:auto;display:block;border-radius:6px}
    .meta{font-size:12px;color:var(--muted);margin-top:6px}
    .ad-slot{border-radius:8px;border:1px dashed #e6eef0;padding:12px;text-align:center;color:var(--muted);}
    footer{margin-top:18px;text-align:center;color:var(--muted);font-size:13px}

    .top-actions{display:flex;gap:8px;flex-wrap:wrap}
    .badge{background:#eef9f9;color:#065f60;padding:6px 8px;border-radius:999px;font-size:12px}

    /* Accessibility focus */
    button:focus, input:focus, select:focus{outline:3px solid rgba(14,165,163,0.12)}
  </style>

</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>Image Resizer</h1>
        <p class="lead">Resize, convert and compress images client-side — fast and privacy-friendly.</p>
      </div>
      <div class="top-actions">
        <span class="badge">Client-side</span>
        <a href="#how" style="text-decoration:none;color:var(--muted);font-size:13px">How it works</a>
      </div>
    </header>

    <main class="grid">
      <!-- Left: main tool -->
      <section class="card" aria-labelledby="uploader">
        <h2 id="uploader" style="font-size:16px;margin:0 0 10px">Upload images</h2>

        <div id="dropzone" class="drop" tabindex="0">
          <p><strong>Drag & drop</strong> or <label for="fileInput" style="color:var(--accent);cursor:pointer">choose files</label></p>
          <p style="font-size:13px;color:var(--muted);margin-top:6px">Supports JPG, PNG, WebP. Multiple files allowed.</p>
          <input id="fileInput" type="file" accept="image/*" multiple style="display:none">
        </div>

        <div class="controls" style="margin-top:14px">
          <div class="row space">
            <div style="flex:1">
              <label for="format">Output format</label>
              <select id="format" aria-label="Output format">
                <option value="auto">Keep original</option>
                <option value="jpeg">JPEG</option>
                <option value="webp">WebP (recommended)</option>
                <option value="png">PNG</option>
              </select>
            </div>

            <div style="width:140px">
              <label for="quality">Quality</label>
              <input id="quality" type="range" min="10" max="100" value="82">
              <div style="display:flex;justify-content:space-between;font-size:12px;color:var(--muted)"><span>10</span><span id="qualityVal">82</span><span>100</span></div>
            </div>
          </div>

          <div class="row">
            <div style="flex:1">
              <label for="maxWidth">Max width (px)</label>
              <input id="maxWidth" type="number" min="1" placeholder="Auto">
            </div>
            <div style="flex:1">
              <label for="maxHeight">Max height (px)</label>
              <input id="maxHeight" type="number" min="1" placeholder="Auto">
            </div>
          </div>

          <div class="row">
            <label style="display:flex;align-items:center;gap:8px"><input id="keepAspect" type="checkbox" checked> Keep aspect ratio</label>
            <label style="margin-left:auto;display:flex;align-items:center;gap:8px"><input id="autoOptimize" type="checkbox"> Auto-optimize (target size MB)</label>
            <input id="targetSize" type="number" placeholder="0.5" step="0.1" style="width:80px" title="Target size in MB" aria-label="Target size in MB">
          </div>

          <div class="row" style="margin-top:6px">
            <button id="processBtn">Process images</button>
            <button class="secondary" id="clearBtn">Clear</button>
            <button class="secondary" id="downloadAllBtn">Download all (.zip)</button>
          </div>

          <div id="progress" class="meta" aria-live="polite"></div>
        </div>

        <div id="preview" class="preview-grid" aria-live="polite" style="margin-top:12px"></div>

      </section>

      <!-- Right: settings + ads -->
      <aside>
        <div class="card">
          <h3 style="margin:0 0 8px">Ad space (top)</h3>
          <div class="ad-slot" role="region" aria-label="Advertisement top">
            <!-- Google AdSense example: replace 'AD_UNIT_ID_HERE' with your ad unit ID -->
            <!--
              To enable AdSense: paste your AdSense script in <head> and set data-ad-client in that script.
              Place this ad unit code where indicated below and replace the data-ad-slot with your Ad Unit ID.
            -->
            <div id="adsense-top" style="max-width:320px;margin:0 auto">
              <ins class="adsbygoogle"
                   style="display:block"
                   data-ad-client="ca-pub-AD_CLIENT_ID_HERE"
                   data-ad-slot="AD_UNIT_ID_HERE"
                   data-ad-format="auto"></ins>
            </div>
          </div>

          <h4 style="margin-top:12px">SEO & Performance tips</h4>
          <ul style="padding-left:16px;color:var(--muted);font-size:14px">
            <li>Use WebP for best compression.</li>
            <li>Serve scaled images matching layout sizes.</li>
            <li>Compress images around 70–85% for web quality.</li>
          </ul>
        </div>

        <div style="height:14px"></div>

        <div class="card">
          <h3 style="margin:0 0 8px">Ad space (bottom)</h3>
          <div class="ad-slot">
            <div id="adsense-bottom">
              <ins class="adsbygoogle"
                   style="display:block"
                   data-ad-client="ca-pub-AD_CLIENT_ID_HERE"
                   data-ad-slot="AD_UNIT_ID_HERE"
                   data-ad-format="auto"></ins>
            </div>
          </div>
        </div>

      </aside>
    </main>

    <footer>
      <small>Built with privacy in mind — images are processed locally in your browser. © <span id="year"></span></small>
    </footer>
  </div>

  <!-- Optional: JSZip for download-all .zip; hosted from CDN. If you prefer not to use external CDN, remove download-all feature. -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.0/jszip.min.js" integrity="sha512-2s2kZ2Ypazv7w4VtI7bqj6c6z8q6Q5r2JcI4Qn4f1c6G1Y1mG1z6z6y6Z1Y1Z6y" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <!-- Optional: AdSense script placeholder (uncomment when you have an AdSense account) -->
  <!--
  <script data-ad-client="ca-pub-AD_CLIENT_ID_HERE" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  -->

  <script>
    // Basic helpers
    const fileInput = document.getElementById('fileInput');
    const dropzone = document.getElementById('dropzone');
    const preview = document.getElementById('preview');
    const processBtn = document.getElementById('processBtn');
    const clearBtn = document.getElementById('clearBtn');
    const downloadAllBtn = document.getElementById('downloadAllBtn');
    const qualityRange = document.getElementById('quality');
    const qualityVal = document.getElementById('qualityVal');
    const formatSelect = document.getElementById('format');
    const progress = document.getElementById('progress');
    const maxWidthInput = document.getElementById('maxWidth');
    const maxHeightInput = document.getElementById('maxHeight');
    const keepAspect = document.getElementById('keepAspect');
    const autoOptimize = document.getElementById('autoOptimize');
    const targetSize = document.getElementById('targetSize');

    let files = [];

    document.getElementById('year').textContent = new Date().getFullYear();

    // Update quality UI
    qualityRange.addEventListener('input', ()=> qualityVal.textContent = qualityRange.value);

    // Drag & drop
    ['dragenter','dragover'].forEach(evt=>{
      dropzone.addEventListener(evt,e=>{e.preventDefault();e.stopPropagation();dropzone.classList.add('dragover')});
    });
    ['dragleave','drop'].forEach(evt=>{
      dropzone.addEventListener(evt,e=>{e.preventDefault();e.stopPropagation();dropzone.classList.remove('dragover')});
    });

    dropzone.addEventListener('drop', e=>{
      if(e.dataTransfer?.files) handleFiles(e.dataTransfer.files);
    });

    dropzone.addEventListener('click', ()=> fileInput.click());
    fileInput.addEventListener('change', ()=> handleFiles(fileInput.files));

    function handleFiles(fileList){
      const arr = Array.from(fileList).filter(f=>f.type.startsWith('image/'));
      if(!arr.length) return;
      files = files.concat(arr);
      renderPreviews();
    }

    function clearAll(){ files = []; preview.innerHTML=''; progress.textContent=''; }
    clearBtn.addEventListener('click', ()=>{ clearAll(); fileInput.value=''; });

    function renderPreviews(){
      preview.innerHTML='';
      files.forEach((file, i)=>{
        const url = URL.createObjectURL(file);
        const box = document.createElement('div'); box.className='preview';
        const img = document.createElement('img'); img.src = url; img.alt = file.name;
        const meta = document.createElement('div'); meta.className='meta';
        meta.innerHTML = `<strong>${escapeHtml(file.name)}</strong><br>${formatBytes(file.size)}`;
        const actions = document.createElement('div'); actions.style.marginTop='8px';
        const removeBtn = document.createElement('button'); removeBtn.className='secondary'; removeBtn.textContent='Remove';
        removeBtn.addEventListener('click', ()=>{ files.splice(i,1); renderPreviews(); });
        actions.appendChild(removeBtn);
        box.appendChild(img); box.appendChild(meta); box.appendChild(actions);
        preview.appendChild(box);
      });
    }

    // Escape helper for filenames
    function escapeHtml(str){ return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

    function formatBytes(bytes){ if(bytes===0) return '0 B'; const k=1024; const sizes=['B','KB','MB','GB']; const i=Math.floor(Math.log(bytes)/Math.log(k)); return parseFloat((bytes/Math.pow(k,i)).toFixed(2))+' '+sizes[i]; }

    // Main processing: resize + compress
    processBtn.addEventListener('click', async ()=>{
      if(files.length===0){ progress.textContent='No images selected.'; return; }
      progress.textContent = `Processing ${files.length} image(s)...`;

      const results = [];
      for(let i=0;i<files.length;i++){
        const f = files[i];
        progress.textContent = `Processing ${i+1}/${files.length}: ${f.name}`;
        try{
          const out = await processImage(f);
          results.push(out);
          addResultPreview(out);
        }catch(err){ console.error(err); }
      }
      progress.textContent = `Done — ${results.length} processed.`;

      // prepare zip for download all
      window._latestResults = results; // store so download-all can access
    });

    async function processImage(file){
      const img = await loadImageFromFile(file);
      // compute target dims
      let maxW = parseInt(maxWidthInput.value) || null;
      let maxH = parseInt(maxHeightInput.value) || null;
      let targetFormat = formatSelect.value === 'auto' ? null : formatSelect.value;
      const quality = parseInt(qualityRange.value)/100;

      let [nw, nh] = [img.width, img.height];
      if(maxW && maxH){
        if(keepAspect.checked){
          const ratio = Math.min(maxW/img.width, maxH/img.height);
          nw = Math.max(1, Math.round(img.width * ratio)); nh = Math.max(1, Math.round(img.height * ratio));
        }else{ nw = maxW; nh = maxH; }
      } else if(maxW && !maxH){
        if(keepAspect.checked){ const ratio = maxW / img.width; nw = maxW; nh = Math.max(1, Math.round(img.height * ratio)); } else nw = maxW;
      } else if(maxH && !maxW){ if(keepAspect.checked){ const ratio = maxH / img.height; nh = maxH; nw = Math.max(1, Math.round(img.width * ratio)); } else nh = maxH; }

      // draw to canvas
      const canvas = document.createElement('canvas'); canvas.width = Math.max(1,nw); canvas.height = Math.max(1,nh);
      const ctx = canvas.getContext('2d');
      ctx.drawImage(img,0,0,canvas.width,canvas.height);

      // decide output mime
      let mime = file.type; // default to original
      if(targetFormat){
        if(targetFormat==='jpeg') mime='image/jpeg';
        else if(targetFormat==='webp') mime='image/webp';
        else if(targetFormat==='png') mime='image/png';
      } else {
        // keep original, but convert PNG to webp/jpg if quality lower than 1.0 and user selected quality < 100: we'll keep mime (PNG ignoring quality)
        mime = file.type;
      }

      // if auto optimize requested, iterative compression to meet target size
      let blob = await toBlobWithQuality(canvas, mime, quality);
      if(autoOptimize.checked && targetSize.value){
        const targetBytes = parseFloat(targetSize.value) * 1024 * 1024;
        blob = await autoOptimizeBlob(canvas, mime, targetBytes);
      }

      const outFile = new File([blob], createOutName(file.name, mime), {type: blob.type});
      return {origName:file.name, outFile, blob, width:canvas.width, height:canvas.height};
    }

    function createOutName(name, mime){
      const base = name.replace(/\.[^.]+$/, '');
      const ext = mime==='image/png' ? '.png' : mime==='image/webp' ? '.webp' : '.jpg';
      return base + '-resized' + ext;
    }

    function loadImageFromFile(file){
      return new Promise((resolve, reject)=>{
        const url = URL.createObjectURL(file);
        const img = new Image();
        img.onload = ()=>{ URL.revokeObjectURL(url); resolve(img); };
        img.onerror = (e)=>{ URL.revokeObjectURL(url); reject(e); };
        img.src = url;
      });
    }

    function toBlobWithQuality(canvas, mime, quality){
      return new Promise((resolve)=>{
        // mime may be 'image/png' where quality param is ignored
        canvas.toBlob((b)=>{ resolve(b); }, mime, quality);
      });
    }

    // iterative reduction: start with given quality and reduce until under target or quality floor
    async function autoOptimizeBlob(canvas, mime, targetBytes){
      let q = parseInt(qualityRange.value)/100;
      let minQ = 0.35; // don't go below 35%
      if(mime==='image/png'){
        // PNG does not support quality param; convert to webp for smaller size unless user explicitly asked png
        if(formatSelect.value==='png'){
          // attempt to export as PNG — if too big, notify user
          const pngBlob = await toBlobWithQuality(canvas, 'image/png', 1);
          if(pngBlob.size <= targetBytes) return pngBlob;
          // else fallthrough to webp conversion
          mime = 'image/webp';
        } else {
          mime = 'image/webp';
        }
      }

      let blob = await toBlobWithQuality(canvas, mime, q);
      // if already small enough, return
      if(blob.size <= targetBytes) return blob;

      // reduce gradually
      while(blob.size > targetBytes && q > minQ){
        q = Math.max(minQ, q - 0.07);
        blob = await toBlobWithQuality(canvas, mime, q);
        // safety break
      }
      return blob;
    }

    function addResultPreview(result){
      const url = URL.createObjectURL(result.blob);
      const box = document.createElement('div'); box.className='preview';
      const img = document.createElement('img'); img.src = url; img.alt = result.outFile.name;
      const meta = document.createElement('div'); meta.className='meta';
      meta.innerHTML = `<strong>${escapeHtml(result.outFile.name)}</strong><br>${result.width}×${result.height} • ${formatBytes(result.blob.size)}`;
      const actions = document.createElement('div'); actions.style.marginTop='8px';
      const dl = document.createElement('a'); dl.href = url; dl.download = result.outFile.name; dl.textContent='Download'; dl.className='secondary'; dl.style.marginRight='8px'; dl.style.padding='8px'; dl.style.borderRadius='8px'; dl.style.textDecoration='none';
      const removeBtn = document.createElement('button'); removeBtn.className='secondary'; removeBtn.textContent='Remove'; removeBtn.addEventListener('click', ()=>{ box.remove(); });
      actions.appendChild(dl); actions.appendChild(removeBtn);
      box.appendChild(img); box.appendChild(meta); box.appendChild(actions);
      preview.appendChild(box);
    }

    // Download all: create zip
    downloadAllBtn.addEventListener('click', async ()=>{
      const results = window._latestResults || [];
      if(!results.length){ progress.textContent='No processed images to download. Click "Process images" first.'; return; }
      progress.textContent = 'Generating ZIP...';
      const zip = new JSZip();
      for(let i=0;i<results.length;i++){
        const r = results[i];
        const arr = await r.blob.arrayBuffer();
        zip.file(r.outFile.name, arr);
      }
      const content = await zip.generateAsync({type:'blob'});
      const url = URL.createObjectURL(content);
      const a = document.createElement('a'); a.href = url; a.download = 'images-resized.zip'; a.click();
      URL.revokeObjectURL(url);
      progress.textContent = 'ZIP ready — download started.';
    });

    // Utility: prevent accidental navigation while files present
    window.addEventListener('beforeunload', (e)=>{
      if(files.length>0) e.returnValue = 'You have unsaved images. Are you sure you want to leave?';
    });

    // tiny accessibility: keyboard activation for dropzone
    dropzone.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' ') fileInput.click(); });

  </script>

  <!-- JSON-LD structured data for SEO -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebApplication",
    "name":"Image Resizer",
    "url":"https://example.com/image-resizer",
    "description":"Resize and compress images client-side in the browser. Supports bulk processing, WebP, JPEG and PNG output.",
    "applicationCategory":"Image Editing",
    "operatingSystem":"All",
    "offers":{
      "@type":"Offer",
      "price":"0",
      "priceCurrency":"USD"
    }
  }
  </script>
</body>
</html>
